<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spardha 4.0 | Triple-Sport Command Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@500;700&display=swap');
        
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #020617; 
            color: #f1f5f9;
            background-image: radial-gradient(circle at top right, rgba(59, 130, 246, 0.1), transparent);
        }

        .glass { background: rgba(15, 23, 42, 0.85); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
        
        .pst-pill { font-size: 0.5rem; font-weight: 800; padding: 2px 5px; border-radius: 4px; text-transform: uppercase; letter-spacing: 0.05em; }
        .p-pill { background: rgba(59, 130, 246, 0.2); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3); }
        .s-pill { background: rgba(245, 158, 11, 0.15); color: #fbbf24; border: 1px solid rgba(245, 158, 11, 0.3); }
        .t-pill { background: rgba(148, 163, 184, 0.15); color: #94a3b8; border: 1px solid rgba(148, 163, 184, 0.3); }
        
        .card-anim { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .card-anim:hover { border-color: rgba(59, 130, 246, 0.3); transform: translateY(-2px); }
    </style>
</head>
<body class="p-4 lg:p-6 min-h-screen">

    <div id="setup-screen" class="max-w-xl mx-auto mt-24 space-y-8">
        <div class="text-center">
            <h1 class="text-5xl font-black tracking-tighter text-white">SPARDHA <span class="text-blue-500">4.0</span></h1>
            <p class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.4em] mt-2">Professional 3-Team Engine</p>
        </div>
        <div class="glass p-10 rounded-[3rem] shadow-2xl space-y-6">
            <div class="space-y-4">
                <p class="text-[10px] font-black text-blue-400 uppercase tracking-widest text-center">Define Tournament Teams</p>
                <input type="text" placeholder="Team 1 Name" class="t-in w-full bg-slate-900 border border-slate-800 rounded-2xl px-6 py-4 outline-none focus:ring-1 focus:ring-blue-500 font-bold">
                <input type="text" placeholder="Team 2 Name" class="t-in w-full bg-slate-900 border border-slate-800 rounded-2xl px-6 py-4 outline-none focus:ring-1 focus:ring-blue-500 font-bold">
                <input type="text" placeholder="Team 3 Name" class="t-in w-full bg-slate-900 border border-slate-800 rounded-2xl px-6 py-4 outline-none focus:ring-1 focus:ring-blue-500 font-bold">
            </div>
            <button onclick="initAuction()" class="w-full bg-blue-600 py-5 rounded-2xl font-black uppercase tracking-widest text-xs hover:bg-blue-500 transition-all shadow-xl">Open Draft Room</button>
        </div>
    </div>

    <div id="main-app" class="hidden max-w-[1900px] mx-auto space-y-6">
        <header class="flex justify-between items-center glass p-5 rounded-[2rem] border-blue-500/10">
            <div class="flex items-center gap-4">
                <div class="h-10 w-10 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/30"><i class="fa-solid fa-gavel text-white text-sm"></i></div>
                <h2 class="text-lg font-black uppercase tracking-tight">Draft <span class="text-blue-500">Command</span></h2>
            </div>
            <div class="flex items-center gap-6">
                <div class="flex items-center gap-3">
                    <span class="text-[10px] font-black text-slate-500 uppercase">Focus:</span>
                    <select id="myTeamSelect" onchange="refreshUI()" class="bg-slate-900 border border-slate-800 rounded-xl px-4 py-2 text-[11px] font-bold text-blue-400 outline-none"></select>
                </div>
                <button onclick="fullReset()" class="h-10 w-10 bg-slate-900 border border-slate-800 rounded-xl text-slate-600 hover:text-red-500 transition-colors"><i class="fa-solid fa-power-off text-xs"></i></button>
            </div>
        </header>

        <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-3 glass rounded-[2.5rem] flex flex-col h-[850px]">
                <div class="p-6 border-b border-slate-800/50">
                    <div class="relative">
                        <i class="fa-solid fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 text-xs"></i>
                        <input type="text" id="mSearch" onkeyup="renderMarket()" placeholder="Search P/S/T Sport..." class="w-full bg-slate-900/50 border border-slate-800 rounded-2xl pl-10 pr-5 py-3.5 text-xs focus:ring-1 focus:ring-blue-500 outline-none font-medium">
                    </div>
                </div>
                <div id="marketList" class="overflow-y-auto flex-grow p-5 space-y-3 custom-scroll"></div>
            </div>

            <div class="col-span-12 lg:col-span-5 h-[850px] overflow-y-auto custom-scroll pr-2">
                <div id="othersGrid" class="space-y-6"></div>
            </div>

            <div class="col-span-12 lg:col-span-4 glass rounded-[3rem] p-8 h-[850px] flex flex-col border-t-4 border-blue-600">
                <div class="flex justify-between items-start mb-8">
                    <div>
                        <h3 id="focusTeamName" class="text-2xl font-black uppercase text-white tracking-tighter">--</h3>
                        <div class="flex gap-4 mt-2">
                            <div class="flex flex-col">
                                <span class="text-[8px] font-black text-slate-500 uppercase">Purse Left</span>
                                <span id="focusPurse" class="text-xl font-bold mono text-emerald-400">200</span>
                            </div>
                            <div class="flex flex-col border-l border-slate-800 pl-4">
                                <span class="text-[8px] font-black text-slate-500 uppercase">Squad Size</span>
                                <span id="focusSquad" class="text-xl font-bold mono text-blue-400">0/18</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="focusDepth" class="flex-grow overflow-y-auto space-y-4 custom-scroll pr-2"></div>
            </div>
        </div>
    </div>

    <script>
        const rawData = [
            ["trisharan@iitbhilai.ac.in","Trisharan Natthu Patil","ECE","Male","Volley ball","Cricket","None"],
            ["anurags@iitbhilai.ac.in","Anurag Singh","Mathematics","Male","Badminton","Athletics","Chess"],
            ["pawankm@iitbhilai.ac.in","Pawan Kumar Mishra","Academic Section","Male","Cricket","Volley ball","Badminton"],
            ["manishs@iitbhilai.ac.in","Manish Sahu","Estate","Male","Cricket","Volley ball","Badminton"],
            ["atripathi@iitbhilai.ac.in","Ashish Kumar Tripathi","BSBME","Male","Cricket","Badminton","None"],
            ["rahul@iitbhilai.ac.in","Rahul Jain","Mechanical","Male","Cricket","Table Tennis","Volley ball"],
            ["krishnab@iitbhilai.ac.in","Balkrishna Mehta","ME","Male","Cricket","None","None"],
            ["arvindy@iitbhilai.ac.in","Arvind Yadav","Registrar's Office","Male","Cricket","Volley ball","Athletics"],
            ["srinivasm@iitbhilai.ac.in","Srinivas Manem","IWD","Male","Volley ball","Badminton","None"],
            ["kunal@iitbhilai.ac.in","KUNAL KUMAR WALDEKAR","DOFA","Male","Cricket","Chess","Athletics"],
            ["yogeshsingh@iitbhilai.ac.in","Dr. Yogesh Pratap Singh","Mechatronics","Male","Cricket","Volley ball","Athletics"],
            ["lkpatra@iitbhilai.ac.in","Lakshmi Kanta Patra","Mathematics","Male","Badminton","Cricket","Volley ball"],
            ["deepakdhiwar@iitbhilai.ac.in","DEEPAK KUMAR DHIWAR","BSBME","Male","Cricket","Basketball","Volley ball"],
            ["yashavant@iitbhilai.ac.in","Yashavant","Hostel","Male","Volley ball","Cricket","Chess"],
            ["minketanp@iitbhilai.ac.in","Minketan Pradhan","Estate","Male","Cricket","Volley ball","Chess"],
            ["nageshpatil@iitbhilai.ac.in","Nagesh D. Patil","Mechanical","Male","Volley ball","Table Tennis","Athletics"],
            ["pawan@iitbhilai.ac.in","Pawan Kumar Mishra","Mathematics","Male","Badminton","Cricket","Table Tennis"],
            ["dhirendrak@iitbhilai.ac.in","Dhirendra Pratap Kare","DoFA","Male","Volley ball","Athletics","Cricket"],
            ["anand@iitbhilai.ac.in","Anand Baswade","CSE","Male","Cricket","Athletics","Chess"],
            ["mdenam@iitbhilai.ac.in","MD MARGHOOB ENAM","LIBRARY","Male","Cricket","Badminton","Volley ball"],
            ["narasimha@iitbhilai.ac.in","M L Narasimha Rao","Computer Science","Male","Chess","None","None"],
            ["swati@iitbhilai.ac.in","Swati Yadav","Mathematics","Female","Badminton","Badminton","Badminton"],
            ["achaudhary@iitbhilai.ac.in","Anjali Chaudhary","Physics","Female","Badminton","Badminton","Badminton"],
            ["bhaskar@iitbhilai.ac.in","Bhaskar Ghawri","Physics","Male","Table Tennis","Table Tennis","Table Tennis"],
            ["rmundotiya@iitbhilai.ac.in","Rajesh Kumar Mundotiya","CSE","Male","Cricket","Badminton","Athletics"],
            ["vivekr@iitbhilai.ac.in","Dr. Vivek Raghuwanshi","ECE","Male","Cricket","Athletics","Badminton"],
            ["arun@iitbhilai.ac.in","Arun Upadhyay","BSBME","Male","Cricket","Badminton","None"],
            ["ganeshkg@iitbhilai.ac.in","Ganesh Kolappan Geetha","Mechanical","Male","Cricket","None","None"],
            ["ashokk@iitbhilai.ac.in","Ashok Kumar","Admin","Male","Cricket","Cricket","Cricket"],
            ["devendra@iitbhilai.ac.in","DEVENDRA MISHRA","DoFA","Male","Table Tennis","Badminton","Volley ball"],
            ["anil@iitbhilai.ac.in","Anil","CSE","Male","Basketball","Cricket","Volley ball"],
            ["ramanandp@iitbhilai.ac.in","Prajapati Ramanand","Mechanical","Male","Table Tennis","Cricket","Badminton"],
            ["kaushaly@iitbhilai.ac.in","Kaushal Kumar","MSME","Male","Cricket","Volley ball","Badminton"],
            ["vedantc@iitbhilai.ac.in","Vedant Choudhary","CPF","Male","Cricket","Volley ball","Table Tennis"],
            ["sanjib@iitbhilai.ac.in","Sanjib Chanda","Admin","Male","Volley ball","Basketball","None"],
            ["senthiln@iitbhilai.ac.in","Senthil Kumar Nadar","MSME","Male","Athletics","Cricket","Badminton"],
            ["nehas@iitbhilai.ac.in","Neha Sahu","Directorate","Female","Table Tennis","Chess","None"],
            ["skumaree@iitbhilai.ac.in","Shailendra Kumar","EE","Male","Badminton","Cricket","Athletics"],
            ["rishi@iitbhilai.ac.in","Rishi Ranjan Singh","CSE","Male","Table Tennis","Badminton","Chess"],
            ["viveksingh@iitbhilai.ac.in","Vivek Singh","Student Affairs","Male","Athletics","Volley ball","Table Tennis"],
            ["sunima@iitbhilai.ac.in","SUNIMA BARAL","LIBRARY","Female","Athletics","None","None"],
            ["hemantverma@iitbhilai.ac.in","Hemant Verma","Directorate","Male","Cricket","Volley ball","Basketball"],
            ["ashutosh@iitbhilai.ac.in","Dr. Ashutosh Kumar","MSME","Male","Cricket","Badminton","None"],
            ["raghvendras@iitbhilai.ac.in","RAGHVENDRA SHARMA","HEALTH CENTRE","Male","Cricket","Table Tennis","Chess"],
            ["sanjaypandey@iitbhilai.ac.in","Sanjay Pandey","Office of Academic Affairs","Male","Volley ball","Cricket","Chess"],
            ["henuverma@iitbhilai.ac.in","Dr Henu Kumar Verma","BSBME","Male","Cricket","Badminton","Table Tennis"],
            ["kmurari@iitbhilai.ac.in","Krishna Murari","EE","Male","Cricket","None","None"],
            ["arzad@iitbhilai.ac.in","Arzad Alam Kherani","ECE","Male","Table Tennis","Chess","Cricket"],
            ["sachin@iitbhilai.ac.in","Sachin Mishra","Administration","Male","Athletics","Cricket","None"],
            ["yogeshnagar@iitbhilai.ac.in","Yogesh Nagar","DoAA","Male","Volley ball","Cricket","Basketball"],
            ["naveenkr@iitbhilai.ac.in","Naveen Kumar Upadhyay","EE","Male","Volley ball","None","None"],
            ["saikat@iitbhilai.ac.in","Saikat Sahoo","Mechatronics","Male","Badminton","Cricket","Table Tennis"],
            ["vigneshr@iitbhilai.ac.in","Vignesh R","CIF","Male","Cricket","None","None"],
            ["reshmab@iitbhilai.ac.in","Reshma Bano","Administration","Female","Chess","Athletics","Badminton"],
            ["mahavir@iitbhilai.ac.in","Mahavir Sharma","Physics","Male","Cricket","None","None"]
        ];

        const sportsList = ["Cricket", "Volley ball", "Badminton", "Table Tennis", "Chess", "Athletics", "Basketball"];
        let db = { teams: [], pool: [], activeIdx: 0, isLive: false };

        function load() {
            const saved = localStorage.getItem('spardha_v4_triple_final');
            if (saved) {
                db = JSON.parse(saved);
                if (db.isLive) {
                    document.getElementById('setup-screen').classList.add('hidden');
                    document.getElementById('main-app').classList.remove('hidden');
                    populateNav();
                    refreshUI();
                }
            }
        }

        function initAuction() {
            const inputs = document.querySelectorAll('.t-in');
            const names = Array.from(inputs).map(i => i.value.trim());
            if (names.some(n => n === "")) return alert("Enter all 3 team names");
            
            db.teams = names.map(n => ({ name: n, purse: 200, squad: [], females: 0 }));
            db.pool = rawData.map(p => ({ id: p[0], name: p[1], dept: p[2], gender: p[3], p: p[4], s: p[5], t: p[6] }));
            db.isLive = true;
            save();
            location.reload();
        }

        function save() { localStorage.setItem('spardha_v4_triple_final', JSON.stringify(db)); }

        function populateNav() {
            const sel = document.getElementById('myTeamSelect');
            sel.innerHTML = db.teams.map((t, i) => `<option value="${i}">${t.name}</option>`).join('');
            sel.value = db.activeIdx;
        }

        function refreshUI() {
            db.activeIdx = parseInt(document.getElementById('myTeamSelect').value);
            renderMarket();
            renderRivals();
            renderFocusDepth();
            save();
        }

        function renderMarket() {
            const query = document.getElementById('mSearch').value.toLowerCase();
            document.getElementById('marketList').innerHTML = db.pool
                .filter(p => p.name.toLowerCase().includes(query) || p.p.toLowerCase().includes(query) || p.s.toLowerCase().includes(query) || p.t.toLowerCase().includes(query))
                .map(p => `
                    <div class="bg-slate-900/40 p-4 rounded-2xl border border-white/5 card-anim">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <p class="text-[11px] font-black text-white uppercase tracking-tight">${p.name}</p>
                                <p class="text-[9px] text-slate-500 font-bold">${p.dept}</p>
                            </div>
                            <button onclick="draftFlow('${p.id}')" class="bg-blue-600 px-3 py-2 rounded-xl text-[10px] font-black uppercase shadow-lg shadow-blue-500/20 active:scale-90 transition-transform">Bid</button>
                        </div>
                        <div class="flex flex-wrap gap-1.5">
                            <span class="pst-pill p-pill">P: ${p.p}</span>
                            <span class="pst-pill s-pill">S: ${p.s}</span>
                            <span class="pst-pill t-pill">T: ${p.t}</span>
                        </div>
                    </div>
                `).join('');
        }

        function draftFlow(id) {
            const p = db.pool.find(x => x.id === id);
            const teamChoices = db.teams.map((t, i) => `${i+1}: ${t.name}`).join('\n');
            const choice = prompt(`Assign ${p.name.toUpperCase()} to:\n${teamChoices}`);
            if (!choice) return;
            const tIdx = parseInt(choice) - 1;
            
            if (db.teams[tIdx]) {
                const team = db.teams[tIdx];
                const max = team.purse - (17 - team.squad.length) * 3;
                const price = parseInt(prompt(`Final Winning Bid for ${p.name}?\n(Team Purse: ${team.purse} | Max Bid Allowed: ${max})`, "3"));

                if (price >= 3 && price <= max) {
                    team.purse -= price;
                    team.squad.push({...p, bid: price});
                    if (p.gender === 'Female') team.females++;
                    db.pool = db.pool.filter(x => x.id !== id);
                    refreshUI();
                } else { alert("Invalid Bid. Ensure bid is >= 3 and purse remains for 18 players."); }
            }
        }

        function renderFocusDepth() {
            const team = db.teams[db.activeIdx];
            document.getElementById('focusTeamName').innerText = team.name;
            document.getElementById('focusPurse').innerText = team.purse;
            document.getElementById('focusSquad').innerText = `${team.squad.length}/18`;
            
            document.getElementById('focusDepth').innerHTML = sportsList.map(s => {
                const members = team.squad.filter(p => p.p === s || p.s === s || p.t === s);
                if (members.length === 0) return '';
                return `
                    <div class="bg-slate-900/60 p-5 rounded-3xl border border-white/5">
                        <div class="flex justify-between items-center mb-4">
                            <p class="text-[10px] font-black text-blue-500 uppercase tracking-widest">${s}</p>
                            <span class="text-[10px] font-bold text-slate-700">${members.length} Players</span>
                        </div>
                        <div class="space-y-2">
                            ${members.map(m => {
                                const tag = m.p === s ? 'P' : (m.s === s ? 'S' : 'T');
                                const pill = tag === 'P' ? 'p-pill' : (tag === 'S' ? 's-pill' : 't-pill');
                                return `<div class="flex justify-between items-center bg-slate-800/30 p-2.5 rounded-xl border border-white/5">
                                    <span class="text-[11px] font-medium"><span class="pst-pill ${pill} mr-2">${tag}</span> ${m.name}</span>
                                    <span class="mono text-blue-500 font-bold text-[11px]">${m.bid}</span>
                                </div>`;
                            }).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderRivals() {
            const others = db.teams.filter((_, i) => i !== db.activeIdx);
            document.getElementById('othersGrid').innerHTML = others.map(t => `
                <div class="glass p-7 rounded-[3rem] border-l-2 border-slate-700">
                    <div class="flex justify-between items-end mb-6">
                        <div>
                            <h4 class="text-lg font-black uppercase text-white tracking-tight">${t.name}</h4>
                            <p class="text-[9px] font-bold text-slate-500 uppercase mt-1">Squad: ${t.squad.length}/18 <span class="text-pink-500 ml-2">Females: ${t.females}</span></p>
                        </div>
                        <div class="text-right">
                            <span class="mono text-emerald-400 font-bold text-lg">$${t.purse}</span>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        ${sportsList.map(s => {
                            const m = t.squad.filter(p => p.p === s || p.s === s || p.t === s);
                            if (m.length === 0) return '';
                            return `
                                <div class="bg-slate-900/40 p-4 rounded-2xl border border-white/5">
                                    <p class="text-[8px] font-black text-slate-600 uppercase mb-3 border-b border-slate-800 pb-1">${s}</p>
                                    <div class="space-y-2">
                                        ${m.map(p => {
                                            const tag = p.p === s ? 'P' : (p.s === s ? 'S' : 'T');
                                            const pill = tag === 'P' ? 'p-pill' : (tag === 'S' ? 's-pill' : 't-pill');
                                            return `<div class="flex justify-between items-center text-[9px] text-slate-400">
                                                <span class="truncate pr-1"><span class="pst-pill ${pill} scale-[0.8] mr-1 inline-block">${tag}</span> ${p.name}</span>
                                                <span class="mono text-slate-500">${p.bid}</span>
                                            </div>`;
                                        }).join('')}
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `).join('');
        }

        function fullReset() { if(confirm("This will clear the entire auction and reset the database. Proceed?")) { localStorage.clear(); location.reload(); } }
        load();
    </script>
</body>
</html>